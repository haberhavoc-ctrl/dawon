<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚´ ì• ë‹ˆë©”ì´ì…˜ ìŠ¤íŠ¸ë¦¬ë°</title>
    <style>
        /* ìŠ¤íƒ€ì¼ì€ ê¹”ë”í•˜ê²Œ ìœ ì§€ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #f4f4f9; color: #333; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        
        header { text-align: center; margin-bottom: 30px; padding: 20px 0; border-bottom: 2px solid #ddd; }
        h1 { font-size: 2.5em; color: #333; margin-bottom: 10px; }
        .loading { text-align: center; font-size: 1.5em; color: #667eea; margin-top: 50px; }

        .search-box { width: 100%; max-width: 500px; padding: 12px; font-size: 1rem; border: 2px solid #ddd; border-radius: 25px; display: block; margin: 0 auto; }

        .anime-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .anime-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.2s; }
        .anime-card:hover { transform: translateY(-5px); }
        .card-img { height: 150px; background: linear-gradient(45deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; font-size: 3em; color: white; }
        .card-title { padding: 15px; font-weight: bold; text-align: center; }

        #playerScreen { display: none; }
        .back-btn { background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-bottom: 15px; font-size: 1rem; }
        
        .player-layout { display: flex; gap: 20px; }
        .video-container { flex: 3; background: black; border-radius: 10px; overflow: hidden; aspect-ratio: 16/9; }
        iframe { width: 100%; height: 100%; border: none; }
        
        .episode-list { flex: 1; background: white; border-radius: 10px; height: 600px; overflow-y: auto; padding: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .ep-btn { display: block; width: 100%; padding: 10px; margin-bottom: 5px; text-align: left; background: #f9f9f9; border: 1px solid #eee; cursor: pointer; border-radius: 5px; }
        .ep-btn:hover { background: #eee; }
        .ep-btn.active { background: #667eea; color: white; border-color: #667eea; }

        @media (max-width: 768px) { .player-layout { flex-direction: column; } .episode-list { height: 300px; } }
    </style>
</head>
<body>

    <div class="container">
        <div id="loading" class="loading">êµ¬ê¸€ ì‹œíŠ¸ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div>

        <div id="mainScreen" style="display:none;">
            <header>
                <h1>ğŸ“º ì• ë‹ˆ ìŠ¤íŠ¸ë¦¬ë°</h1>
                <input type="text" id="searchInput" class="search-box" placeholder="ì œëª© ê²€ìƒ‰..." onkeyup="filterAnime()">
            </header>
            <div id="animeGrid" class="anime-grid"></div>
        </div>

        <div id="playerScreen">
            <button class="back-btn" onclick="goBack()">â† ëª©ë¡ìœ¼ë¡œ</button>
            <h2 id="playerTitle" style="margin-bottom:10px;">ì œëª©</h2>
            <div class="player-layout">
                <div class="video-container">
                    <iframe id="videoPlayer" src="" allowfullscreen></iframe>
                </div>
                <div class="episode-list" id="episodeList"></div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <script>
        // ============================================================
        // â˜… 1. êµ¬ê¸€ ì‹œíŠ¸ ë§í¬ ì…ë ¥ (ì—¬ê¸°ì— ë§í¬ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”)
        // ============================================================
        const GOOGLE_SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSbKVr6ekiv_h0pDericy-75P_eXQBVfveHvF4HeSQYnEjG45bbOlONf3nz6F9uTkFrDxW4e8-nW3O1/pub?gid=2046105107&single=true&output=csv"; 

        // ============================================================
        // â˜… 2. ì• ë‹ˆë©”ì´ì…˜ ì´ë¦„ ì„¤ì • (IDì— ë§ëŠ” ì œëª©ì„ ì ì–´ì£¼ì„¸ìš”)
        // ì—‘ì…€ì— 'ì œëª©' ì¹¸ì´ ì—†ì–´ì„œ ì—¬ê¸°ì„œ ì •í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.
        // ============================================================
        const ANIME_TITLES = {
            1: "ë¸”ë¦¬ì¹˜ (Bleach)",
            2: "ê°€ë”ì”© íˆ­í•˜ê³  ëŸ¬ì‹œì•„ì–´ë¡œ ë¶€ë„ëŸ¬ì›Œí•˜ëŠ” ì•„ë¼ì–‘", 
            3: "Re: ì œë¡œë¶€í„° ì‹œì‘í•˜ëŠ” ì´ì„¸ê³„ ìƒí™œ 1ê¸°",
            4: "Re: ì œë¡œë¶€í„° ì‹œì‘í•˜ëŠ” ì´ì„¸ê³„ ìƒí™œ 2ê¸°",
            5: "Re: ì œë¡œë¶€í„° ì‹œì‘í•˜ëŠ” ì´ì„¸ê³„ ìƒí™œ 3ê¸°",
            // ìƒˆë¡œìš´ ì• ë‹ˆë©”ì´ì…˜ì„ ì¶”ê°€í•˜ë©´ ì—¬ê¸°ì— "ë²ˆí˜¸: ì œëª©"ì„ ì¶”ê°€í•˜ì„¸ìš”.
        };

        let allAnimeData = {}; 

        window.onload = function() {
            if (GOOGLE_SHEET_CSV_URL.includes("ì—¬ê¸°ì—")) {
                alert("ì½”ë“œì— êµ¬ê¸€ ì‹œíŠ¸ ë§í¬ë¥¼ ë„£ì–´ì£¼ì„¸ìš”!");
                return;
            }

            Papa.parse(GOOGLE_SHEET_CSV_URL, {
                download: true,
                header: true,
                skipEmptyLines: true, 
                complete: function(results) {
                    processData(results.data);
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('mainScreen').style.display = 'block';
                },
                error: function(err) {
                    alert("ë°ì´í„° ë¡œë”© ì‹¤íŒ¨! ë§í¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
                }
            });
        };

        // ë°ì´í„° ì²˜ë¦¬ í•¨ìˆ˜ (ì‚¬ìš©ìì˜ í—¤ë”ì— ë§ì¶¤)
        function processData(rows) {
            allAnimeData = {};

            rows.forEach(row => {
                // ì‚¬ìš©ìê°€ ë§í•œ í—¤ë” ì´ë¦„: "ì• ë‹ˆë©”ì´ì…˜ ID", "íšŒì°¨ë²ˆí˜¸", "íšŒì°¨ì œëª©", "URL"
                // ë„ì–´ì“°ê¸°ê°€ í˜¹ì‹œ ë‹¤ë¥¼ê¹Œë´ ë‘ ê°€ì§€ ê²½ìš°ë¥¼ ë‹¤ ì²´í¬í•©ë‹ˆë‹¤.
                const rawId = row['ì• ë‹ˆë©”ì´ì…˜ ID'] || row['ì• ë‹ˆë©”ì´ì…˜ID'];
                
                if (!rawId) return; // IDê°€ ì—†ìœ¼ë©´ ê±´ë„ˆëœ€

                const id = rawId.trim();
                const epNum = row['íšŒì°¨ë²ˆí˜¸'];
                const epTitle = row['íšŒì°¨ì œëª©'];
                const videoUrl = row['URL'];

                // í•´ë‹¹ ì• ë‹ˆë©”ì´ì…˜ ID ê·¸ë£¹ì´ ì—†ìœ¼ë©´ ìƒì„±
                if (!allAnimeData[id]) {
                    // ì œëª©ì€ ìœ„ì—ì„œ ì„¤ì •í•œ ANIME_TITLESì—ì„œ ê°€ì ¸ì˜¤ê±°ë‚˜, ì—†ìœ¼ë©´ IDë¥¼ í‘œì‹œ
                    const titleName = ANIME_TITLES[id] || `ì• ë‹ˆë©”ì´ì…˜ ${id}`;
                    
                    allAnimeData[id] = {
                        id: id,
                        title: titleName,
                        icon: getIcon(titleName),
                        episodes: []
                    };
                }

                // ì—í”¼ì†Œë“œ ì •ë³´ ì¶”ê°€
                if (epNum && videoUrl) {
                    allAnimeData[id].episodes.push({
                        ep: epNum,
                        title: epTitle,
                        url: videoUrl
                    });
                }
            });

            renderMainList();
        }

        function renderMainList() {
            const grid = document.getElementById('animeGrid');
            grid.innerHTML = "";

            Object.values(allAnimeData).forEach(anime => {
                const card = document.createElement('div');
                card.className = 'anime-card';
                card.onclick = () => openPlayer(anime.id);
                card.innerHTML = `
                    <div class="card-img">${anime.icon}</div>
                    <div class="card-title">${anime.title} <br><small>ì´ ${anime.episodes.length}í™”</small></div>
                `;
                grid.appendChild(card);
            });
        }

        function openPlayer(id) {
            const anime = allAnimeData[id];
            
            // íšŒì°¨ ë²ˆí˜¸ìˆœ ì •ë ¬
            anime.episodes.sort((a, b) => parseInt(a.ep) - parseInt(b.ep));

            document.getElementById('mainScreen').style.display = 'none';
            document.getElementById('playerScreen').style.display = 'block';
            document.getElementById('playerTitle').innerText = anime.title;

            const listContainer = document.getElementById('episodeList');
            listContainer.innerHTML = "";

            anime.episodes.forEach(ep => {
                const btn = document.createElement('div');
                btn.className = 'ep-btn';
                btn.innerHTML = `<b>${ep.ep}í™”</b>: ${ep.title}`;
                btn.onclick = () => {
                    playVideo(ep.url);
                    document.querySelectorAll('.ep-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                };
                listContainer.appendChild(btn);
            });

            if (anime.episodes.length > 0) {
                listContainer.firstChild.click();
            }
        }

        function playVideo(url) {
            document.getElementById('videoPlayer').src = url;
        }

        function goBack() {
            document.getElementById('playerScreen').style.display = 'none';
            document.getElementById('mainScreen').style.display = 'block';
            document.getElementById('videoPlayer').src = "";
        }

        function filterAnime() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const cards = document.querySelectorAll('.anime-card');
            cards.forEach(card => {
                const title = card.querySelector('.card-title').innerText.toLowerCase();
                card.style.display = title.includes(query) ? 'block' : 'none';
            });
        }

        function getIcon(title) {
            if(title.includes('ë¸”ë¦¬ì¹˜')) return 'âš”ï¸';
            if(title.includes('ê°€ë”ì”© ëŸ¬ì‹œì•„ì–´ë¡œ ë¶€ë„ëŸ¬ì›Œí•˜ëŠ” ì•„ë¼ì–‘')) return 'ğŸ¥';
            if(title.includes('Re: ì œë¡œë¶€í„° ì‹œì‘í•˜ëŠ” ì´ì„¸ê³„ ìƒí™œ 1ê¸°')) return 'ã…—ã…—';
            if(title.includes('Re: ì œë¡œë¶€í„° ì‹œì‘í•˜ëŠ” ì´ì„¸ê³„ ìƒí™œ 2ê¸°'))  return 'ğŸ¬';
            if(title.includes('Re: ì œë¡œë¶€í„° ì‹œì‘í•˜ëŠ” ì´ì„¸ê³„ ìƒí™œ 3ê¸°'))  return 'ã…—';
            return 'ğŸ¬';
        }
    </script>
</body>
</html>










